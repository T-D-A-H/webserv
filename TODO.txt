ERRORES DE headers

1. Header correctness

Multiple Host headers â†’ 400 Bad Request

Missing Host in HTTP/1.1 â†’ 400

Duplicate or malformed headers â†’ 400

Invalid characters in headers (per RFC 7230) â†’ 400

2. Request target (Path/URI) validation

If path is malformed (e.g., contains spaces or invalid percent-encoding) â†’ 400

If path tries directory traversal (../etc/passwd) â†’ 403 Forbidden

If path exceeds length limit (some servers use ~8kB cutoff) â†’ 414 URI Too Long

3. Content-Length and body validation

Content-Length must be a valid number if present â†’ else 400

For methods that require a body (POST, PUT):

Missing Content-Length (or Transfer-Encoding: chunked) â†’ 411 Length Required

If body size exceeds server limits â†’ 413 Payload Too Large

If both Content-Length and Transfer-Encoding are present â†’ 400 Bad Request

4. Transfer-Encoding

If unsupported (e.g., chunked not implemented) â†’ 501 Not Implemented

5. Connection handling

If Connection: close header is set, mark connection for closing after response.

If unsupported Connection directives â†’ ignore or 400

6. MIME/content-type handling

For POST/PUT, check Content-Type.
If server doesnâ€™t support it (e.g., you only handle application/x-www-form-urlencoded), you might reject â†’ 415 Unsupported Media Type

7. Method-specific rules

TRACE â†’ return a 501 if you donâ€™t want to support it (security).

CONNECT â†’ usually not supported except in proxies â†’ 501.

8. Security sanity checks

Reject request lines with:

Control characters

Non-ASCII in method/version

CRLF injection in headers (\r\n inside header values) â†’ 400

9. Range requests (optional, advanced)

If you decide to implement Range: support â†’ validate it.

If invalid â†’ 416 Range Not Satisfiable

ðŸ”¹ Extended error codes you may want

400 â†’ Malformed request

401 Unauthorized â†’ If you later add authentication

403 Forbidden â†’ Path exists but forbidden (permissions, traversal attempt, etc.)

404 Not Found â†’ Resource not found

405 Method Not Allowed â†’ Method not allowed for resource

411 Length Required â†’ Missing Content-Length for methods requiring body

413 Payload Too Large â†’ Body exceeds server max

414 URI Too Long â†’ Path/query too long

415 Unsupported Media Type â†’ Unsupported Content-Type

416 Range Not Satisfiable â†’ Invalid Range header

500 Internal Server Error â†’ Catch-all for unhandled failures

501 Not Implemented â†’ Method or feature not implemented

505 HTTP Version Not Supported â†’ Invalid HTTP version